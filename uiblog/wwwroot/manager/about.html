<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>about me 管理</title>
    <link rel="stylesheet" href="/css/index.all.css" />
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    
    <script>
        
    </script>
</head>
<body>
    <!--    page header nav start   -->
    <nav class="nav">
        <!--    page header nav container start   -->
        <div class="container">
            <!--    header logo start   -->
            <a href="/manager/index.html">
                <h2 class="nav-title">about me 管理</h2>
            </a>
            <!--    header logo end   -->
        </div>
        <!--    page header nav container end   -->

    </nav>
    <!--    page header nav end   -->

    <!--    page main start -->
    <div class="main">
        <textarea id="editor1" name="editor" placeholder="Type your text here...">
            
            Lorem ipsum dolor sit amet, consectetur adipisici elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua.
        
            Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquid ex ea commodi consequat. Quis aute iure reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
        
            Excepteur sint obcaecat cupiditat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    
        </textarea>
        <div><input type="button" id="btnSubmit" value="提交保存" /></div>
    </div>
    <!--    page main end -->

    <!--    page footer start -->
    <div class="footer">
        <div class="copyright">
            © 2017 by OdinSam
        </div>
    </div>
    <!--    page footer end -->

    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/tinymce/tinymce.min.js"></script>
    <script src="/js/js.cookie.js"></script>
    <script src="/js/jquery.ajax.dinjonya.js"></script>
    <script src="/js/ajax.url.js"></script>
    <script src="/js/app.js"></script>
    <script src="/js/manage.index.js"></script>
    <script src="/js/manage.about.js"></script>
    <script>
        $(function(){
            App.init();
            ManageIndex.init();
            ManageAbout.init();
            tinymce.init({
                selector: '#editor1',
                theme: 'modern',
                plugins: 'image,textcolor,codesample,colorpicker,fullscreen,link',
                toolbar: 'undo redo | forecolor backcolor | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image imagetools | codesample | fullscreen',
                menubar: false,
                Height: 400,
                file_browser_callback_types: 'file image',
                images_upload_url: 'http://127.0.0.1:18080/apiblog/api1.0/BlogManager/UploadImage',
                images_upload_base_path: '/images/upload',
                images_upload_credentials: true,
                automatic_uploads: true,
                images_upload_handler: function (blobInfo, success, failure) {
                    var xhr, formData;
                    xhr = new XMLHttpRequest();
                    xhr.withCredentials = false;
                    xhr.open('POST', 'http://127.0.0.1:18080/apiblog/api1.0/BlogManager/UploadImage');
                    xhr.onload = function() {
                      var json;
                      if (xhr.status != 200) {
                        failure('HTTP Error: ' + xhr.status);
                        return;
                      }
                      json = JSON.parse(xhr.responseText);
                
                      if (!json || typeof json.location != 'string') {
                        failure('Invalid JSON: ' + xhr.responseText);
                        return;
                      }
                      success(json.location);
                    };
                    formData = new FormData();
                    console.log(blobInfo.name());
                    
                    formData.append('file', blobInfo.blob(), blobInfo.name());
                    xhr.send(formData);
                    
                }
            });
        })
    </script>
</body>
</html>